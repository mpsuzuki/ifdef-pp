# このコードの目的と前提

## このコードは C プリプロセッサの完全な模倣ではありません。

次の 3 状態の論理を扱うための独自の評価器です。

* defined（ユーザが -D で指定した）
* undefined（ユーザが -U で指定した）
* pending（どちらでも指定されていない）

## 重要な点：

* pending は C プリプロセッサには存在しませんが、
	このツールではundefinedは明示的に指定するもので、
	指定されていないマクロはpendingとなります。
	このツールに必須の概念です。
* pending となっているマクロは条件を確定できないため、
	これを含む`#if` 構造は簡約せずに残す必要があります。

## 目的は「ユーザが指定した -D/-U の範囲で可能な限り条件を簡約し、未確定部分は残す」ことです。

このツールは「C プリプロセッサの厳密な動作を再現する」ことが目的ではありません。
したがって、C の常識（整数比較、短絡評価、マクロ未定義は 0 など）を適用してはいけません。

## このツールの評価規則は次の通り：

* defined → TRUE
* undefined → FALSE
* pending → PENDING
* AND / OR / NOT は 3 値論理で評価する
* PENDING が含まれる式は、TRUE または FALSE が確定しない限り PENDING のまま残す

この世界観を前提にして議論してください。
